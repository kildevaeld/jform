!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.jform=e():t.jform=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function r(t,e){if(void 0===e&&(e={}),"string"==typeof t){var n=document.querySelector(t);if(!n)return null;e.el=n}else t instanceof HTMLElement?e.el=t:e=t;return new o.Form(e)}var o=n(20),s=n(21),l=n(27),u=n(1),a=n(24);i(n(20)),e.create=r;var c;!function(t){function e(t,e){var n=u.Editor.extend(e,{});return s.set(n,t),n}function n(t){return s.get(t)}t.ValidationError=a.FormValidationError,t.extend=e,t.get=n}(c=e.editors||(e.editors={}));var h;!function(t){function e(t,e,i){l.Validator.validators[t]=e,n(t,i)}function n(t,e){l.Validator.messages[t]=e}t.add=e,t.addMessage=n}(h=e.validators||(e.validators={}))},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(2),o=n(19),s=function(t){function e(){t.apply(this,arguments),this.name="EditorImplementationError"}return i(e,t),e}(o.FormError),l=function(t){function e(){t.apply(this,arguments),this.name="EditorError"}return i(e,t),e}(o.FormError),u=function(t){function e(e){if(!e||!e.name)throw new l("no name specified");this.label=e.label,this._name=e.name,this._defaultValue=e.defaultValue,t.call(this,e)}return i(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},set:function(t){this.setValue(t)},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){throw new s("setValue not implemented")},e.prototype.getValue=function(){throw new s("getValue not implemented")},e.prototype.clear=function(){throw new s("clear not implemented")},e.prototype.validate=function(){return null},e.prototype.triggerChange=function(t){this.triggerMethod("change",this)},e.prototype.render=function(){return this.undelegateEvents(),t.prototype.render.call(this),this.delegateEvents(),this},e.prototype.setDefault=function(){null!=this._defaultValue&&this.setValue(this._defaultValue)},e}(r.TemplateView);e.Editor=u;var a=function(t){function e(e){if(!e||!e.name)throw new l("no name specified");this._name=e.name,this._defaultValue=e.defaultValue,t.call(this,e)}return i(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},set:function(t){this.setValue(t)},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){throw new s("setValue not implemented")},e.prototype.getValue=function(){throw new s("getValue not implemented")},e.prototype.clear=function(){throw new s("clear not implemented")},e.prototype.validate=function(){return null},e.prototype.triggerChange=function(t){this.triggerMethod("change",this)},e.prototype.setDefault=function(){null!=this._defaultValue&&this.setValue(this._defaultValue)},e}(r.CollectionView);e.CollectionEditor=a},function(t,e,n){function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(5)),i(n(4)),i(n(9)),i(n(8)),i(n(7)),i(n(6)),i(n(12)),i(n(11)),i(n(3)),i(n(13)),i(n(14)),i(n(15)),i(n(16)),i(n(17)),i(n(18)),i(n(10))},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(4),o=n(11),s=n(9),l=n(12),u=function(t){function e(e){this._regionManager=new o.RegionManager,s.utils.proxy(this,this._regionManager,["removeRegion","removeRegions"]),this._regions=this.getOption("regions",e||{}),t.call(this,e)}return i(e,t),Object.defineProperty(e.prototype,"regions",{get:function(){return this._regionManager.regions},enumerable:!0,configurable:!0}),e.prototype.render=function(e){return this.triggerMethod("before:render"),t.prototype.render.call(this,{silent:!0}),this.addRegion(this._regions||{}),this.triggerMethod("render"),this},e.prototype.addRegion=function(t,e){var n={};if("string"==typeof t){if(null==e)throw new Error("add region");n[t]=e}else n=t;for(var i in n){var r=l.Region.buildRegion(n[i],this.el);this._regionManager.addRegion(i,r)}},e.prototype.removeRegion=function(t){this._regionManager.removeRegion(t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this._regionManager.destroy()},e}(r.TemplateView);e.LayoutView=u},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(5),o=n(10),s=o.logger("templateview"),l=function(t){function e(e){e&&e.template&&(this.template=e.template),t.call(this,e)}return i(e,t),e.prototype.getTemplateData=function(){return{}},e.prototype.render=function(t){return void 0===t&&(t={}),t.silent||this.triggerMethod("before:render"),this.renderTemplate(this.getTemplateData()),t.silent||this.triggerMethod("render"),this},e.prototype.renderTemplate=function(t){var e=this.getOption("template");"function"==typeof e&&(s("%s render template function",this.cid),e=e.call(this,t)),e&&"string"==typeof e&&(s("%s attach template: %s",this.cid,e),this.attachTemplate(e))},e.prototype.attachTemplate=function(t){this.undelegateEvents(),this.el.innerHTML=t,this.delegateEvents()},e}(r.View);e.TemplateView=l},function(t,e,n){function i(t,e){var n,i,r,o,s,l={};for(n in t)i=t[n],null!==(r=u.exec(n))&&(s=r[1],o=e[s],null!=o&&(n=n.replace(r[0],o))),l[n]=i;return l}var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},o=n(6),s=n(9),l=n(10),u=/@ui.([a-zA-Z_\-\$#]+)/i,a=l.logger("view");e.normalizeUIKeys=i;var c=function(t){function e(e){this._options=e,t.call(this,e)}return r(e,t),e.prototype.delegateEvents=function(e){this._bindUIElements(),e=e||this.events,e=i(e,this._ui);var n=this._configureTriggers();return e=s.utils.extend({},e,n),a("%s delegate events %j",this.cid,e),t.prototype.delegateEvents.call(this,e),this},e.prototype.undelegateEvents=function(){return this._unbindUIElements(),a("%s undelegate events",this.cid),t.prototype.undelegateEvents.call(this),this},e.prototype._bindUIElements=function(){var t=this,e=this.getOption("ui");e&&(this._ui||(this._ui=e),e=s.utils.result(this,"_ui"),this.ui={},Object.keys(e).forEach(function(n){var i=t.$(e[n]);i&&i.length?(i instanceof NodeList&&(i=i[0]),a("added ui element %s %s",n,e[n]),t.ui[n]=i):console.warn("view ",t.cid,": ui element not found ",n,e[n])}))},e.prototype._unbindUIElements=function(){},e.prototype._configureTriggers=function(){var t=this.getOption("triggers")||{};"function"==typeof t&&(t=t.call(this)),t=i(t,this._ui);var e,n,r={};for(n in t)e=t[n],a("added trigger %s %s",n,e),r[n]=this._buildViewTrigger(e);return r},e.prototype._buildViewTrigger=function(t){"string"==typeof t&&(t={event:t});var e=s.utils.extend({preventDefault:!0,stopPropagation:!0},t);return function(t){t&&(t.preventDefault&&e.preventDefault&&t.preventDefault(),t.stopPropagation&&e.stopPropagation&&t.stopPropagation()),this.triggerMethod(e.event,{view:this,model:this.model,collection:this.collection})}},e}(o.BaseView);e.View=c},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(7),o=n(9),s=n(10),l=s.logger("baseview"),u=/^\s*</,a="focus blur change".split(" "),c=["el","id","attributes","className","tagName","events"],h=function(t){function e(e){void 0===e&&(e={}),this._cid=o.utils.uniqueId("view"),o.utils.extend(this,o.utils.pick(e,c)),this._domEvents=[],null==this.el?this._ensureElement():this.delegateEvents(),t.call(this,e)}return i(e,t),e.find=function(t,e){return e.querySelectorAll(t)},Object.defineProperty(e.prototype,"cid",{get:function(){return this._cid},enumerable:!0,configurable:!0}),e.prototype.delegateEvents=function(t){var e=this;if(!t&&!(t=o.utils.result(this,"events")))return this;this.undelegateEvents();var n=[];for(var i in t){var r=t[i];"function"!=typeof r&&(r=this[r]);var s=i.match(/^(\S+)\s*(.*)$/),l=o.utils.bind(r,this);s[2]?this.delegate(s[1],s[2],l):n.push([s[1],l])}return n.forEach(function(t){e.delegate(t[0],t[1])}),this},e.prototype.undelegateEvents=function(){if(this.el){for(var t=0,e=this._domEvents.length;e>t;t++){var n=this._domEvents[t];o.html.removeEventListener(this.el,n.eventName,n.handler)}this._domEvents.length=0}return this},e.prototype.delegate=function(t,e,n){"function"==typeof e&&(n=e,e=null);var i=this.el,r=e?function(t){var r=t.target||t.srcElement;if(!t.delegateTarget)for(;r&&r!=i;r=r.parentNode)o.html.matches(r,e)&&(t.delegateTarget=r,n(t))}:function(t){t.delegateTarget||n(t)},s=!!~a.indexOf(t)&&null!=e;return l("%s delegate event %s ",this.cid,t),o.html.addEventListener(this.el,t,r,s),this._domEvents.push({eventName:t,handler:r,listener:n,selector:e}),r},e.prototype.undelegate=function(t,e,n){if("function"==typeof e&&(n=e,e=null),this.el)for(var i=this._domEvents.slice(),r=0,s=i.length;s>r;r++){var l=i[r],u=l.eventName===t&&(n?l.listener===n:!0)&&(e?l.selector===e:!0);u&&(o.html.removeEventListener(this.el,l.eventName,l.handler),this._domEvents.splice(o.utils.indexOf(i,l),1))}return this},e.prototype.render=function(t){return this},e.prototype.appendTo=function(t){if(t instanceof HTMLElement)t.appendChild(this.el);else{var e=document.querySelector(t);e?e.appendChild(this.el):void 0}return this},e.prototype.append=function(t,e){if(null!=e){var n=this.$(e);n instanceof NodeList&&n.length>0?n[0].appendChild(t):n instanceof HTMLElement&&n.appendChild(t)}else this.el.appendChild(t);return this},e.prototype.$=function(t){return t instanceof HTMLElement?t:e.find(t,this.el)},e.prototype.setElement=function(t){this.undelegateEvents(),this._setElement(t),this.delegateEvents()},e.prototype.remove=function(){return this._removeElement(),this},e.prototype._createElement=function(t){return document.createElement(t)},e.prototype._ensureElement=function(){if(this.el)this.setElement(o.utils.result(this,"el"));else{var t=o.utils.extend({},o.utils.result(this,"attributes"));this.id&&(t.id=o.utils.result(this,"id")),this.className&&(t["class"]=o.utils.result(this,"className")),l("%s created element: %s",this.cid,o.utils.result(this,"tagName")||"div"),this.setElement(this._createElement(o.utils.result(this,"tagName")||"div")),this._setAttributes(t)}},e.prototype._removeElement=function(){this.undelegateEvents(),this.el.parentNode&&this.el.parentNode.removeChild(this.el)},e.prototype._setElement=function(t){if("string"==typeof t)if(u.test(t)){var e=document.createElement("div");e.innerHTML=t,this.el=e.firstElementChild}else this.el=document.querySelector(t);else this.el=t},e.prototype._setAttributes=function(t){for(var e in t)e in this.el?this.el[e]=t[e]:this.el.setAttribute(e,t[e])},e}(r.BaseObject);e.BaseView=h},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(8),o=n(9),s=n(10),l=s.logger("object"),u=function(t){function e(e){t.call(this),this._isDestroyed=!1,"function"==typeof this.initialize&&o.utils.call(this.initialize,this,o.utils.slice(arguments))}return i(e,t),Object.defineProperty(e.prototype,"isDestroyed",{get:function(){return this._isDestroyed},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy"),this.stopListening(),this.off(),this._isDestroyed=!0,this.triggerMethod("destroy"),l("%s destroy",this),Object.freeze(this),this)},e.prototype.triggerMethod=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return o.utils.triggerMethodOn(this,t,e),this},e.prototype.getOption=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return this.options&&e.push(this.options),this._options&&e.push(this._options),e.push(this),o.utils.getOption(t,e)},e.extend=o.extend,e}(r.EventEmitter);e.BaseObject=u},function(t,e){function n(){return""+ ++i}var i=0,r=function(){function t(){}return Object.defineProperty(t.prototype,"listeners",{get:function(){return this._listeners},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,i){void 0===i&&(i=!1);var r=(this._listeners||(this._listeners={}))[t]||(this._listeners[t]=[]);return r.push({name:t,once:i,handler:e,ctx:n||this}),this},t.prototype.once=function(t,e,n){return this.on(t,e,n,!0)},t.prototype.off=function(t,e){if(null==t)this._listeners={};else if(this._listeners[t]){var n=this._listeners[t];if(null==e)this._listeners[t]=[];else for(var i=0;i<n.length;i++){n[i];n[i].handler==e&&this._listeners[t].splice(i,1)}}},t.prototype.trigger=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=(this._listeners||(this._listeners={}))[e]||(this._listeners[e]=[]);r=r.concat(this._listeners.all||[]),t.debugCallback&&t.debugCallback(this.constructor.name,this.name,e,n);var o,s,l,u;r.length;for(u=0;u<r.length;u++)o=r[u],s=n,"all"==o.name&&(s=[e].concat(n)),o.handler.apply(o.ctx,s),o.once===!0&&(l=this._listeners[o.name].indexOf(o),this._listeners[o.name].splice(l,1));return this},t.prototype.listenTo=function(t,e,i,r,o){void 0===o&&(o=!1);var s,l,u;return s=this._listeningTo||(this._listeningTo={}),l=t.listenId||(t.listenId=n()),s[l]=t,u=o?"once":"on",t[u](e,i,this),this},t.prototype.listenToOnce=function(t,e,n,i){return this.listenTo(t,e,n,i,!0)},t.prototype.stopListening=function(t,e,n){var i=this._listeningTo;if(!i)return this;var r=!e&&!n;n||"object"!=typeof e||(n=this),t&&((i={})[t.listenId]=t);for(var o in i)t=i[o],t.off(e,n,this),(r||!Object.keys(t.listeners).length)&&delete this._listeningTo[o];return this},t}();e.EventEmitter=r},function(t,e){function n(t,e){var n,i=this;n=t&&a.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},a.extend(n,i,e);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,t&&a.extend(n.prototype,t),n.__super__=i.prototype,n}function i(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;var o=toString.call(t);if(o!=toString.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!==+t?e!==+e:0===t?1/t===1/e:t===+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=n.length;s--;)if(n[s]==t)return r[s]==e;var l=t.constructor,u=e.constructor;if(l!==u&&!("function"==typeof l&&l instanceof l&&"function"==typeof u&&u instanceof u))return!1;n.push(t),r.push(e);var c=0,h=!0;if("[object Array]"===o){if(c=t.length,h=c===e.length)for(;c--&&(h=i(t[c],e[c],n,r)););}else{for(var f in t)if(a.has(t,f)&&(c++,!(h=a.has(e,f)&&i(t[f],e[f],n,r))))break;if(h){for(f in e)if(a.has(e,f)&&!c--)break;h=!c}}return n.pop(),r.pop(),h}var r="undefined"!=typeof Element&&Element.prototype||{},o=r.matches||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector||function(t){var e=(this.parentNode||document).querySelectorAll(t)||[];return!!~a.indexOf(e,this)},s=r.addEventListener||function(t,e){return this.attachEvent("on"+t,e)},l=r.removeEventListener||function(t,e){return this.detachEvent("on"+t,e)};e.extend=n;var u;!function(t){function e(t,e){return o.call(t,e)}function n(t,e,n,i){void 0===i&&(i=!1),s.call(t,e,n,i)}function i(t,e,n){l.call(t,e,n)}function r(t,e){t.classList?t.classList.add(e):t.className=t.className.split(" ").concat(e.split(" ")).join(" ")}function u(t,e){t.classList?t.classList.remove(e):t.className=t.className.split(" ").concat(e.split(" ")).join(" ")}function a(t){if("selectionStart"in t)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange(),n=document.selection.createRange().text.length;return e.moveStart("character",-t.value.length),e.text.length-n}}t.matches=e,t.addEventListener=n,t.removeEventListener=i,t.addClass=r,t.removeClass=u,t.selectionStart=a}(u=e.html||(e.html={}));var a,c=Function.prototype.bind,h=0;!function(t){function e(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function n(t){return void 0===t&&(t=""),t+ ++h}function r(t){return t===Object(t)}function o(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(!t.isObject(e))return e;for(var r,o,s=0;s<n.length;s++)if(r=n[s],t.isObject(r))for(o in r)t.has(r,o)&&(e[o]=r[o]);return e}function s(e,n){for(var i,r={},o=0;o<n.length;o++)i=n[o],t.has(e,i)&&(r[i]=e[i]);return r}function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function u(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1}function a(e,n,i,r){var o=e[n];return"function"==typeof o?t.call(o,i,r||[]):o}function f(e){var n=[];for(var i in e)t.has(e,i)&&n.push(e[i]);return n}function p(t,e,n){var i,r;for(i=0;i<t.length;i++)if(r=t[i],e.call(n,r))return r;return null}function d(e,n,i){Array.isArray(i)||(i=[i]),i.forEach(function(i){"function"==typeof n[i]&&(e[i]=t.bind(n[i],n))})}function g(e,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if("function"!=typeof e)throw new Error("method not at function");if(null!=c)return c.call.apply(c,[e,n].concat(i));i=i||[];var o=function(){},s=function(){var r=this instanceof o?this:n;return t.call(e,r,i.concat(t.slice(arguments)))};return o.prototype=this.prototype,s.prototype=new o,s}function y(t,e,n){switch(void 0===n&&(n=[]),n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2]);case 4:return t.call(e,n[0],n[1],n[2],n[3]);case 5:return t.call(e,n[0],n[1],n[2],n[3],n[4]);default:return t.apply(e,n)}}function v(t){return Array.prototype.slice.call(t)}function m(t){return t.reduce(function(t,e){return t.concat(Array.isArray(e)?m(e):e)},[])}function _(t,e){return i(t,e,[],[])}function b(n,i,r){var o=e("on-"+i.replace(":","-"));n[o]&&"function"==typeof n[o]&&t.call(n[o],n,r),"function"==typeof n.trigger&&(r=[i].concat(r),t.call(n.trigger,n,r))}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(r(i)&&i[t])return i[t]}return null}function E(t,e,n){var i="function"==typeof e?e:function(t){return t[e]};return t.map(function(t,e,r){return{value:t,index:e,criteria:i.call(n,t,e,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}).map(function(t){return t.value})}function O(t){return t&&"function"==typeof t.then}function V(t){return t?O(t)?t:"function"==typeof t?x.call(this,t):Array.isArray(t)?C.call(this,t):r(t)?j.call(this,t):Promise.resolve(t):t}function x(t){var e=this;return new Promise(function(n,i){t.call(e,function(t,e){return t?i(t):(arguments.length>2&&(e=v.call(arguments,1)),void n(e))})})}function C(t){return Promise.all(t.map(V,this))}function j(t){function e(t,e){n[e]=void 0,r.push(t.then(function(t){n[e]=t}))}for(var n=new t.constructor,i=Object.keys(t),r=[],o=0;o<i.length;o++){var s=i[o],l=V.call(this,t[s]);l&&O(l)?e(l,s):n[s]=t[s]}return Promise.all(r).then(function(){return n})}function P(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={};return r.promise=new Promise(function(t,e){r.resolve=t,r.reject=e,r.done=function(n,i){return n?e(n):void t(i)}}),"function"==typeof t?(t.apply(e,n.concat([r.done])),r.promise):r}function M(t,e,n){t.then(function(t){e.call(n,null,t)})["catch"](function(t){e.call(n,t)})}function R(t){var e=P();return setTimeout(e.resolve,t),e.promise}t.camelcase=e,t.uniqueId=n,t.isObject=r,t.extend=o,t.pick=s,t.has=l,t.indexOf=u,t.result=a,t.values=f,t.find=p,t.proxy=d,t.bind=g,t.call=y,t.slice=v,t.flatten=m,t.equal=_,t.triggerMethodOn=b,t.getOption=w,t.sortBy=E,t.isPromise=O,t.toPromise=V,t.thunkToPromise=x,t.arrayToPromise=C,t.objectToPromise=j,t.deferred=P,t.callback=M,t.delay=R}(a=e.utils||(e.utils={}))},function(t,e,n){function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function r(t){a=t}function o(t){return t instanceof Error?t.stack||t.message:t}function s(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];if(a){e[0]=o(e[0]),"string"!=typeof e[0]&&(e=["%o"].concat(e));var r=0;e[0]=e[0].replace(/%([a-z%])/g,function(t,n){if("%%"===t)return t;r++;var i=c[n];if("function"==typeof i){var o=e[r];t=i.call(self,o),e.splice(r,1),r--}return t}),e=l(t,e),u.utils.call(i,null,e)}}}function l(t,e){return e[0]="[views:"+t+"] "+e[0],e}var u=n(9),a=!1;e.debug=r;var c={j:function(t){return JSON.stringify(t)}};e.logger=s},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(7),o=n(12),s=n(9),l=function(t){function e(){t.call(this),this._regions={}}return i(e,t),Object.defineProperty(e.prototype,"regions",{get:function(){return this._regions},enumerable:!0,configurable:!0}),e.prototype.addRegions=function(t){var e,n={},i=Object.keys(t);return i.forEach(function(i){e=t[i],n[i]=this.addRegion(i,e)},this),n},e.prototype.addRegion=function(t,e){var n=o.Region.buildRegion(e);return this._setRegion(t,n),n},e.prototype.removeRegion=function(t){"string"==typeof t&&(t=[t]),t.forEach(function(t){if(s.utils.has(this.regions,t)){var e=this.regions[t];e.destroy(),this._unsetRegion(t)}},this)},e.prototype.destroy=function(){this.removeRegions(),t.prototype.destroy.call(this)},e.prototype.removeRegions=function(){s.utils.call(this.removeRegion,this,Object.keys(this._regions))},e.prototype._setRegion=function(t,e){this._regions[t]&&this._regions[t].destroy(),this._regions[t]=e},e.prototype._unsetRegion=function(t){delete this._regions[t]},e}(r.BaseObject);e.RegionManager=l},function(t,e,n){function i(t,e){if(void 0===t&&(t={}),!t.selector)throw new Error("No selector specified: "+t);return r(t.selector,t.regionClass||u,e)}function r(t,e,n){void 0===e&&(e=u),n=n||document;var i=n.querySelector(t);if(!i)throw new Error("selector must exist in the dom");return new e({el:i})}var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},s=n(7),l=n(9),u=function(t){function e(e){this.options=e,this._el=this.getOption("el"),t.call(this)}return o(e,t),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},set:function(t){this.show(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0}),e.buildRegion=function(t,n){return void 0===n&&(n=null),t instanceof e?t:"string"==typeof t?r(t,e,n):i(t,n)},e.prototype.show=function(t,e){var n=t!==this._view;return n&&(this.empty(),t.once("destroy",this.empty,this),t.render(),l.utils.triggerMethodOn(t,"before:show"),this._attachHtml(t),l.utils.triggerMethodOn(t,"show"),this._view=t),this},e.prototype.destroy=function(){this.empty(),t.prototype.destroy.call(this)},e.prototype.empty=function(){if(this._view){var t=this._view;return t.off("destroy",this.empty,this),this.trigger("before:empty",t),this._destroyView(),this.trigger("empty",t),delete this._view,this}},e.prototype._attachHtml=function(t){this._el.innerHTML="",this._el.appendChild(t.el)},e.prototype._destroyView=function(){var t=this._view;t.destroy&&"function"==typeof t.destroy&&!t.isDestroyed?t.destroy():t.remove&&"function"==typeof t.remove&&t.remove(),this._el.innerHTML=""},e}(s.BaseObject);e.Region=u},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(4),o=n(9),s=function(t){function e(e){void 0===e&&(e={}),e.model&&(this.model=e.model),e.collection&&(this.collection=e.collection),t.call(this,e)}return i(e,t),Object.defineProperty(e.prototype,"model",{get:function(){return this._model},set:function(t){this.setModel(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"collection",{get:function(){return this._collection},set:function(t){this.setCollection(t)},enumerable:!0,configurable:!0}),e.prototype.setModel=function(t){this._model!==t&&(this.triggerMethod("before:model",this._model,t),this._model&&this.stopListening(this._model),this._model=t,this.triggerMethod("model",t))},e.prototype.setCollection=function(t){this._collection!==t&&(this.triggerMethod("before:collection",this._collection,t),this._collection&&this.stopListening(this._collection),this._collection=t,this.triggerMethod("collection",t))},e.prototype.getTemplateData=function(){return this.model?"function"==typeof this.model.toJSON?this.model.toJSON():this.model:{}},e.prototype.delegateEvents=function(e){e=e||this.events;var n=this._filterEvents(e),i=n.c,r=n.e,o=n.m;return t.prototype.delegateEvents.call(this,r),this._delegateDataEvents(o,i),this},e.prototype.undelegateEvents=function(){return this._undelegateDataEvents(),t.prototype.undelegateEvents.call(this),this},e.prototype._delegateDataEvents=function(t,e){var n=this;this._dataEvents={};var i=function(t,e){if(!n[t])return{};var i,r,s={};for(i in e)r=o.utils.bind(e[i],n),n[t].on(i,r),s[t+":"+i]=r;return s};o.utils.extend(this._dataEvents,i("model",t),i("collection",e))},e.prototype._undelegateDataEvents=function(){if(this._dataEvents){var t,e;for(t in this._dataEvents){e=this._dataEvents[t];var n=t.split(":"),i=n[0],r=n[1];this[i]&&this[i].off(r,e)}delete this._dataEvents}},e.prototype._filterEvents=function(t){var e,n,i={},r={},o={};for(e in t){var s=e.split(" "),l=s[0],u=s[1];l=l.trim(),u=u?u.trim():"",n=t[e],"collection"===u?i[l]=n:"model"===u?r[l]=n:o[e]=n}return{c:i,m:r,e:o}},e}(r.TemplateView);e.DataView=s},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(13),o=n(9),s=n(8),l=n(10),u=l.logger("collectionview"),a=function(){function t(){this.children=[],this.buffer=document.createDocumentFragment()}return t.prototype.append=function(t){this.children.push(t),this.buffer.appendChild(t.el)},t}(),c=function(t){function e(e){this.children=[],this.sort=e&&null!=e.sort?e.sort:!0,t.call(this,e)}return i(e,t),e.prototype.render=function(e){return this.destroyChildren(),this._destroyContainer(),t.prototype.render.call(this,e),this._initContainer(),this.collection&&this.collection.length&&this.renderCollection(),this},e.prototype.setCollection=function(e){t.prototype.setCollection.call(this,e),this._delegateCollectionEvents()},e.prototype.renderCollection=function(){this.destroyChildren(),0!=this.collection.length?(this.hideEmptyView(),this._startBuffering(),this._renderCollection(),this._stopBuffering()):this.showEmptyView()},e.prototype.getChildView=function(t){var e=this.getOption("childView")||r.DataView,n=this.getOption("childViewOptions")||{};return new e(o.utils.extend({model:t},n))},e.prototype.renderChildView=function(t,e){this.triggerMethod("before:render:child",t),u("%s render child: %s",this.cid,t.cid),t.render(),this._attachHTML(t,e),this.triggerMethod("render:child",t)},e.prototype.showEmptyView=function(){},e.prototype.hideEmptyView=function(){},e.prototype.destroyChildren=function(){this._container&&(this._container.innerHTML=""),0!==this.children.length&&(this.children.forEach(this.removeChildView,this),this.children=[])},e.prototype.removeChildView=function(t){t&&("function"==typeof t.destroy&&t.destroy(),"function"==typeof t.remove&&t.remove(),this.stopListening(t),this.children.splice(this.children.indexOf(t),1),0===this.children.length&&this.showEmptyView(),this._updateIndexes(t,!1))},e.prototype.destroy=function(){return this.triggerMethod("before:destroy:children"),this.destroyChildren(),this.triggerMethod("destroy:children"),this.hideEmptyView(),t.prototype.destroy.call(this)},e.prototype._renderCollection=function(){var t=this;this.triggerMethod("before:render:collection"),this.collection.forEach(function(e,n){var i=t.getChildView(e);t._appendChild(i,n)}),this.triggerMethod("render:collection")},e.prototype._appendChild=function(t,e){this._updateIndexes(t,!0,e),this._proxyChildViewEvents(t),u("%s append child %s at index: %s",this.cid,t.cid,e),this.children.push(t),this.hideEmptyView(),this.renderChildView(t,e),this.triggerMethod("add:child",t)},e.prototype._attachHTML=function(t,e){this._buffer?(u("%s attach to buffer: %s",this.cid,t.cid),this._buffer.append(t)):this._insertBefore(t,e)||this._insertAfter(t)},e.prototype._proxyChildViewEvents=function(t){var e=this.getOption("prefix")||"childview";this.listenTo(t,"all",function(){var n=o.utils.slice(arguments);n[0]=e+":"+n[0],n.splice(1,0,t),o.utils.call(this.triggerMethod,this,n)})},e.prototype._updateIndexes=function(t,e,n){this.sort&&(e&&(t._index=n),this.children.forEach(function(n){n._index>=t._index&&(e?n._index++:n._index--)}))},e.prototype._startBuffering=function(){this._buffer=new a},e.prototype._stopBuffering=function(){this._container.appendChild(this._buffer.buffer),delete this._buffer},e.prototype._initContainer=function(){var t=this.getOption("childViewContainer");t=t?this.$(t)[0]:this.el,this._container=t},e.prototype._destroyContainer=function(){this._container&&delete this._container},e.prototype._insertBefore=function(t,e){var n,i=this.sort&&e<this.children.length-1;return i&&(n=o.utils.find(this.children,function(t){return t._index===e+1})),n?(this._container.insertBefore(t.el,n.el),!0):!1},e.prototype._insertAfter=function(t){this._container.appendChild(t.el)},e.prototype._delegateCollectionEvents=function(){this.collection&&this.collection instanceof s.EventEmitter&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._onCollectionSort))},e.prototype._onCollectionAdd=function(t){var e=this.getChildView(t),n=this.collection.indexOf(t);this._appendChild(e,n)},e.prototype._onCollectionRemove=function(t){var e=o.utils.find(this.children,function(e){return e.model===t});this.removeChildView(e)},e.prototype._onCollectionSort=function(){var t=this,e=this.collection.find(function(e,n){var i=o.utils.find(t.children,function(t){return t.model===e});return!i||i._index!==n});e&&this.render()},e}(r.DataView);e.CollectionView=c},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(9),o=n(7),s=function(t){function e(e,n){void 0===e&&(e={}),n=n||{},this._attributes=e,this.uid=r.utils.uniqueId("uid"),this._changed={},this.collection=n.collection,t.call(this)}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.idAttribute in this._attributes?this._attributes[this.idAttribute]:this.uid},enumerable:!0,configurable:!0}),e.prototype.set=function(t,e,n){void 0===n&&(n={});var i,o,s,l,u,a,c,h={};if(null==t)return this;"object"==typeof t?(h=t,n=e):h[t]=e,n||(n={}),o=n.unset,l=n.silent,s=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=r.utils.extend(Object.create(null),this._attributes),this._changed={}),c=this._attributes,a=this._previousAttributes;for(i in h)e=h[i],r.utils.equal(c[i],e)||s.push(i),
r.utils.equal(a[i],e)?delete this._changed[i]:this._changed[i]=e,o?delete c[i]:c[i]=e;if(!l){s.length&&(this._pending=!!n);for(var f=0,p=s.length;p>f;f++)this.trigger("change:"+s[f],this,c[s[f]],n)}if(u)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},e.prototype.get=function(t){return this._attributes[t]},e.prototype.unset=function(t,e){this.set(t,void 0,r.utils.extend({},e,{unset:!0}))},e.prototype.has=function(t){return null!=this.get(t)},e.prototype.hasChanged=function(t){return null==t?!!Object.keys(this.changed).length:r.utils.has(this.changed,t)},e.prototype.clear=function(t){var e={};for(var n in this._attributes)e[n]=void 0;return this.set(e,r.utils.extend({},t,{unset:!0}))},Object.defineProperty(e.prototype,"changed",{get:function(){return r.utils.extend({},this._changed)},enumerable:!0,configurable:!0}),e.prototype.changedAttributes=function(t){if(!t)return this.hasChanged()?r.utils.extend(Object.create(null),this.changed):!1;var e,n={},i=this._changing?this._previousAttributes:this._attributes;for(var o in t)r.utils.equal(i[o],e=t[o])||((n||(n={}))[o]=e);return n},e.prototype.previous=function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},e.prototype.previousAttributes=function(){return r.utils.extend(Object.create(null),this._previousAttributes)},e.prototype.toJSON=function(){return JSON.parse(JSON.stringify(this._attributes))},e.prototype.clone=function(){return new this.constructor(this._attributes)},e}(o.BaseObject);e.Model=s},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(7),o=n(9),s=n(15),l={add:!0,remove:!0,merge:!0},u={add:!0,remove:!1},a=function(t){function e(e,n){void 0===n&&(n={}),this.options=n,this.options.model&&(this.Model=this.options.model),e&&this.add(e),t.call(this)}return i(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.models.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Model",{get:function(){return this._model||(this._model=s.Model),this._model},set:function(t){this._model=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"models",{get:function(){return this._models||(this._models=[])},enumerable:!0,configurable:!0}),e.prototype.add=function(t,e){var n=this;void 0===e&&(e={}),Array.isArray(t)?t=t.map(function(t){return t instanceof n.Model?t:n.create(t,{add:!1})}):t instanceof this.Model||(t=this.create(t,{add:!1})),this.set(t,o.utils.extend({merge:!1},e,u))},e.prototype.set=function(t,e){void 0===e&&(e={}),e=o.utils.extend({},l,e),e.parse&&(t=this.parse(t,e));var n,i,r,s,u,a,c,h=!Array.isArray(t),f=h?t?[t]:[]:t.slice(),p=e.at,d=this.comparator&&null==p&&e.sort!==!1,g="string"==typeof this.comparator?this.comparator:null,y=[],v=[],m={},_=e.add,b=e.merge,w=e.remove,E=!d&&_&&w?[]:null;for(n=0,i=f.length;i>n;n++){if(s=f[n],r=s.get(s.idAttribute)||s.uid,a=this.get(r))w&&(m[a.uid]=!0),b&&(u=s.toJSON(),a.set(u,e),d&&!c&&a.hasChanged(g)&&(c=!0)),f[n]=a;else if(_){if(f[n]=s,!s)continue;y.push(s),this._addReference(s,e)}s=a||s,E&&!m[s.id]&&E.push(s),m[s.uid]=!0}if(w){for(n=0,i=this.length;i>n;++n)m[(s=this.models[n]).uid]||v.push(s);v.length&&this.remove(v,e)}if(y.length||E&&E.length)if(d&&(c=!0),null!=p)for(n=0,i=y.length;i>n;n++)this.models.splice(p+n,0,y[n]);else{E&&(this.models.length=0);var O=E||y;for(n=0,i=O.length;i>n;n++)this.models.push(O[n])}if(c&&this.sort({silent:!0}),!e.silent){for(n=0,i=y.length;i>n;n++)(s=y[n]).trigger("add",s,this,e);(c||E&&E.length)&&this.trigger("sort",this,e),(y.length||v.length)&&this.trigger("update",this,e)}return h?f[0]:f},e.prototype.remove=function(t,e){void 0===e&&(e={});var n=!Array.isArray(t);t=n?[t]:t.slice();var i,r,o,s;for(i=0,r=t.length;r>i;i++)s=t[i]=this.get(t[i]),s&&(o=this.indexOf(s),this.models.splice(o,1),e.silent||(e.index=o,s.trigger("remove",s,this,e)),this._removeReference(s,e));return n?t[0]:t},e.prototype.get=function(t){return this.find(t)},e.prototype.at=function(t){return this.models[t]},e.prototype.clone=function(t){return t=t||this.options,new this.constructor(this.models,t)},e.prototype.sort=function(t){if(void 0===t&&(t={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");return"string"==typeof this.comparator||1===this.comparator.length?this._models=this.sortBy(this.comparator,this):this.models.sort(this.comparator.bind(this)),t.silent||this.trigger("sort",this,t),this},e.prototype.sortBy=function(t,e){return o.utils.sortBy(this._models,t,e)},e.prototype.push=function(t,e){return void 0===e&&(e={}),this.add(t,o.utils.extend({at:this.length},e))},e.prototype.reset=function(t,e){var n=this;return void 0===e&&(e={}),this.forEach(function(t){n._removeReference(t,e)}),e.previousModels=this.models,this._reset(),t=this.add(t,e),e.silent||this.trigger("reset",this,e),t},e.prototype.create=function(t,e){void 0===e&&(e={add:!0});var n=new this.Model(t,e);return e.add&&this.add(n),n},e.prototype.parse=function(t,e){return void 0===e&&(e={}),t},e.prototype.find=function(t){var e;return e="function"==typeof t?o.utils.find(this.models,t):o.utils.find(this.models,function(e){return e.id==t||e.uid==t||t===e})},e.prototype.forEach=function(t,e){for(var n=0,i=this.models.length;i>n;n++)t.call(e||this,this.models[n],n);return this},e.prototype.indexOf=function(t){return this.models.indexOf(t)},e.prototype.toJSON=function(){return this.models.map(function(t){return t.toJSON()})},e.prototype._removeReference=function(t,e){this===t.collection&&delete t.collection,this.stopListening(t)},e.prototype._addReference=function(t,e){t.collection||(t.collection=this),this.listenTo(t,"all",this._onModelEvent)},e.prototype._reset=function(){this._models=[]},e.prototype._onModelEvent=function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),o.utils.call(this.trigger,this,o.utils.slice(arguments)))},e.prototype.destroy=function(){var e=this;this.models.forEach(function(t){"function"==typeof t.destroy&&t.collection==e&&t.destroy()}),t.prototype.destroy.call(this)},e}(r.BaseObject);e.Collection=a},function(t,e){},function(t,e,n){function i(t){return function(e){s.utils.extend(e.prototype,t)}}function r(t){return function(e){e.prototype.events=t}}function o(t){return function(e){e.prototype.triggers=t}}var s=n(9);e.attributes=i,e.events=r,e.triggers=o},function(t,e){var n=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},i=function(){function t(t,e){this.name="FormError",this.message=t}return t.prototype.toString=function(){return this.name+": "+this.message},t.prototype.toJSON=function(){return{name:this.name,message:this.message,code:this.code}},t}();e.FormError=i;var r=function(t){function e(e,n,i){t.call(this,i),this.name="FormValidationError",this.name=e,this.value=n}return n(e,t),e}(i);e.FormValidationError=r;var o=function(t){function e(e,n){t.call(this,null),this.name=e,this.errors=n}return n(e,t),e.prototype.toJSON=function(){return{name:this.name,errors:this.errors.map(function(t){return t.message})}},e}(i);e.FormEditorValidationError=o},function(t,e,n){function i(t){return t.reduce(function(t,e){return t.concat(Array.isArray(e)?i(e):e)},[])}function r(t,e){return e?e.replace(/\{{name\}}/,t.label||t.name):null}function o(t,e,n,i){return void 0===i&&(i=!1),new Promise(function(n,r){function o(c,h){return c&&!i?r(c):(c&&a.push(c),s===l?a.length?r(u.utils.flatten(a)):n():void e(t[s++]).then(function(t){o(null,t)},o))}var s=0,l=t.length,a=[];o(null)})}function s(t){var e=[],n=t.length,r=Array(n),o=0,s=n-0;return 0===n?Promise.resolve():new Promise(function(l,u){function a(t,n){t.then(function(t){return r[n]=t,0===--s?e.length?u(i(e)):l(r.length?r:null):void 0},function(t){e.push(t),0===--s&&u(i(e))})}for(o;n>o;o++)a(t[o],o)})}var l=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},u=n(2),a=n(21),c=n(19),h=n(27);u.EventEmitter.debugCallback=function(t,e,n,i){console.log(e||t,n,i)};var f=function(t){function e(n){null!=n&&(n=u.utils.extend({},e.defaults,n)),t.call(this,n),this.strict=n.strict||this.strict||!1,this.autoValidate=n.autoValidate||this.autoValidate||!1,this._validator=n.validator||new h.Validator,this._validations={}}return l(e,t),Object.defineProperty(e,"defaults",{get:function(){return{selector:"[name]",attribute:"form-editor"}},enumerable:!0,configurable:!0}),e.prototype.render=function(e){return this._destroyEditors(),t.prototype.render.call(this,e),this._renderEditors(),this},Object.defineProperty(e.prototype,"val",{get:function(){return this.getValue()},set:function(t){this.setValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editors",{get:function(){return u.utils.extend({},this._editors)},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){this.trigger("before:setvalue",t);for(var e in t)if(this.editors[e]){this.trigger("before:setvalue:"+e);try{this.editors[e].setValue(t[e])}catch(n){}this.trigger("setvalue:"+e)}else{var i="form does not have an editor for: '"+e+"'";if(this.strict)throw new c.FormError(i);console.warn(i)}return this.trigger("setvalue"),this},e.prototype.getValue=function(){var t={};for(var e in this.editors){var n=this.editors[e];t[e]=n.getValue()}return t},e.prototype.clear=function(){this.triggerMethod("before:clear");for(var t in this.editors)this.editors[t].clear();this.triggerMethod("clear")},e.prototype.validateEditor=function(t){var e=this,n=this.editors[t];if(!n)return Promise.reject(new c.FormError("no editor named "+t));var i=h.errorToPromise(n.validate()),o=[];if(i&&o.push(i),this._validations[n.name]){var l=n.getValue(),u=this._validations[n.name].map(function(t){return h.errorToPromise(e._validator.validate(n.el,l,t))});o=o.concat(u)}return s(o)["catch"](function(t){t.forEach(function(t){var e=t.message||h.Validator.messages[t.name];t.message=r(n,e)});var e=new c.FormEditorValidationError(n.name,t);throw n.trigger("invalid",e),e})},e.prototype.validate=function(){var t=this,e=Object.keys(this.editors);return o(e,function(e){return t.validateEditor.call(t,e)},this,!0).then(function(t){return null})["catch"](function(t){var e={};return t.forEach(function(t){console.log(t),e[t.name]=t}),e})},e.prototype._getElements=function(t,e){var n,i,r,o,s=t.querySelectorAll(e.selector),l={};for(n=0;n<s.length;n++){i=s[n],r=i.getAttribute(e.attribute);var h=i.getAttribute("name");r=r||this._getType(i);var f=a.get(r);if(null!=f){o=i.getAttribute("required");var p=u.utils.result(e,h,void 0,[this,e])||{};p=u.utils.extend(p,e.editors[h]||{}),p.name=h,p.el=i,null!=o&&(p.validations||(p.validations=[])).push({name:"required"});var d=new f(p);p.validations&&this._validator&&(this._validator.bootstrap&&this._validator.bootstrap(i),this._validations[h]=p.validations),this.listenTo(d,"change",this._onEditorChange),this.listenTo(d,"invalid",this._onEditorInvalid),l[h]=d}else{var g="editor not found: '"+r+"' for '"+h+"'";if(this.strict)throw new c.FormError(g);console.warn(g)}}return l},e.prototype._renderEditors=function(){this._editors=this._getElements(this.el,this._options||{});for(var t in this._editors)this._editors[t].render()},e.prototype._destroyEditors=function(){for(var t in this.editors)this.stopListening(this.editors[t]),this.editors[t].destroy();this._editors={}},e.prototype._onEditorChange=function(t){this.trigger("change",t)},e.prototype._onEditorInvalid=function(t){var e=this.editors[t.name];this.trigger("invalid",e,t)},e.prototype._getType=function(t){return"INPUT"===t.nodeName?t.type.toLowerCase():t.nodeName.toLowerCase()},e.prototype.destroy=function(){this._destroyEditors(),t.prototype.destroy.call(this)},e}(u.TemplateView);e.Form=f},function(t,e,n){function i(t){return null!=r(t)}function r(t){return c[t]}function o(t,e){c[e]=t}var s=n(22),l=n(23),u=n(25),a=n(26),c={input:s.InputEditor,text:s.InputEditor,checkbox:s.InputEditor,radio:s.InputEditor,textarea:s.InputEditor,list:l.ListEditor,number:u.NumberEditor,select:a.SelectEditor};e.has=i,e.get=r,e.set=o},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=this&&this.__decorate||function(t,e,n,i){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,i);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,i){return void(i&&i(e,n))},void 0);case 4:return t.reduceRight(function(t,i){return i&&i(e,n,t)||t},i)}},o=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},s=n(1),l=n(2),u=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.setValue=function(t){"INPUT"===this.el.nodeName&&~["checkbox","radio"].indexOf(this.el.type)?this.el.checked=!!t:"INPUT"===this.el.nodeName&&"file"===this.el.type||(this.el.value=null==t?"":t)},e.prototype.getValue=function(){return"INPUT"===this.el.nodeName&&~["checkbox","radio"].indexOf(this.el.type)?this.el.checked:"INPUT"===this.el.nodeName&&"file"===this.el.type?this.el.files:""===this.el.value?null:this.el.value},e.prototype.clear=function(){this.el.value="",this.setDefault()},e.prototype._onChange=function(){var t=this.getValue();l.utils.equal(t,this._prev)||this.triggerChange()},e=r([l.events({change:"_onChange"}),o("design:paramtypes",[])],e)}(s.Editor);e.InputEditor=u},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=n(2),o=n(24),s=r.CollectionView.extend({tagName:"select",events:{change:function(t){var e=this.el.options[this.el.selectedIndex],n=e.getAttribute("cid"),i=r.utils.find(this.children,function(t){return t.cid===n});if(null==i)throw new o.FormError("could not find view for option "+n);this.trigger("select",i.model)}},childView:r.DataView.extend({tagName:"option",template:function(t){return this.el.setAttribute("value",t.value),this.el.setAttribute("cid",this.cid),t.name}},{})},{}),l=function(t){function e(){t.apply(this,arguments),this.idAttribute="value"}return i(e,t),e}(r.Model);e.ListEditorModel=l;var u=function(t){function e(e){var n=this;if(e.items&&(e.collection=new r.Collection(e.items,{model:l})),this._name=e.name,this._values=new r.Collection(e.values||[]),this._selectView=new s({collection:e.collection||new r.Collection([])}),this._listView=new r.CollectionView({tagName:"ul",collection:this._values,childViewOptions:{triggers:{click:"click"},tagName:"li",template:function(t){return t.name}}}),this.listenTo(this._listView,"childview:click",function(t){var e=t.model;this._values.remove(e)}),this.listenTo(this._selectView,"select",function(t){n._values.add(t.clone())}),null==this.name)throw new o.FormError("name property is required");t.call(this,e)}return i(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"val",{get:function(){return this.getValue()},set:function(t){this.setValue(t)},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){this._values.reset(t)},e.prototype.getValue=function(){return this._values.toJSON()},e.prototype.clear=function(){this._values.reset([])},e.prototype.validate=function(){return null},e.prototype.render=function(){return this.el.appendChild(this._selectView.render().el),this.el.appendChild(this._listView.render().el),this},e.prototype.destroy=function(){this._selectView.destroy(),this._listView.destroy(),t.prototype.destroy.call(this)},e}(r.View);e.ListEditor=u},function(t,e){var n=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},i=function(){function t(t,e){this.name="FormError",this.message=t}return t.prototype.toString=function(){return this.name+": "+this.message},t.prototype.toJSON=function(){return{name:this.name,message:this.message,code:this.code}},t}();e.FormError=i;var r=function(t){function e(e,n,i){t.call(this,i),this.name="FormValidationError",this.name=e,this.value=n}return n(e,t),e}(i);e.FormValidationError=r;var o=function(t){function e(e,n){t.call(this,null),this.name=e,this.errors=n}return n(e,t),e.prototype.toJSON=function(){return{name:this.name,errors:this.errors.map(function(t){return t.message})}},e}(i);e.FormEditorValidationError=o},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=this&&this.__decorate||function(t,e,n,i){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,i);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,i){return void(i&&i(e,n))},void 0);case 4:return t.reduceRight(function(t,i){return i&&i(e,n,t)||t},i)}},o=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},s=n(2),l=n(1),u=function(t){function e(e){t.call(this,e),this._floating=null==e["float"]?!1:e["float"]}return i(e,t),e.prototype._onKeyPress=function(t){var e=String.fromCharCode(t.which),n=this.el.value;if(8==t.which&&(e=e.substr(0,e.length-2)),!~n.indexOf(",")&&","===e&&this._floating){var i=this.el.selectionStart;if(""!=n&&0!==i)return;this.el.value="0,"+this.el.value,this.el.setSelectionRange(2,2)}isNaN(parseFloat(e))&&t.preventDefault()},e.prototype.setValue=function(t){this.el.value=""+(this._floating?t:Math.round(t))},e.prototype.getValue=function(){var t=this.el.value;return""===t?null:this._floating?parseFloat(t.replace(",",".")):parseInt(t)},e.prototype.clear=function(){this.el.value="",this.setDefault()},e=r([s.events({keypress:"_onKeyPress"}),o("design:paramtypes",[Object])],e)}(l.Editor);e.NumberEditor=u},function(t,e,n){var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},r=this&&this.__decorate||function(t,e,n,i){if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)return Reflect.decorate(t,e,n,i);switch(arguments.length){case 2:return t.reduceRight(function(t,e){return e&&e(t)||t},e);case 3:return t.reduceRight(function(t,i){return void(i&&i(e,n))},void 0);case 4:return t.reduceRight(function(t,i){return i&&i(e,n,t)||t},i)}},o=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},s=n(2),l=n(1),u=function(t){function e(e){t.call(this,e)}return i(e,t),e.prototype.setValue=function(t){for(var e=null,n=0;n<this.el.options.length;n++){var i=this.el.options[n];if(i.value===t.value&&i.innerText===t.text){e=n;break}}null!==e&&(this.el.selectedIndex=e)},e.prototype.getValue=function(){var t=this.el.options[this.el.selectedIndex];return{value:t.value,text:t.innerText}},e.prototype.clear=function(){this.setDefault()},e=r([s.events({change:"triggerChange"}),o("design:paramtypes",[Object])],e)}(l.Editor);e.SelectEditor=u},function(t,e,n){function i(t){return t instanceof Error||t instanceof r.FormValidationError?Promise.reject(t):o.utils.isPromise(t)?t:Promise.resolve(null)}var r=n(24),o=n(2);e.errorToPromise=i;var s=function(){function t(){}return t.prototype.validate=function(e,n,o){if("required"===o.name)return null==n?Promise.reject(new r.FormValidationError("required",n)):null;if(t.validators[o.name]){var s=t.validators[o.name](e,n);return i(s)}return null},t.validators={},t.messages={},t}();e.Validator=s}])});